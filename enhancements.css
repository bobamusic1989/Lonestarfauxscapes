/**
 * Tier 1 Visual Enhancements
 * High-impact UI/UX improvements
 */

/* ==========================================================================
   FEATURE DETECTION & PROGRESSIVE ENHANCEMENT
   ========================================================================== */

/* Base glass panel - solid fallback for unsupported browsers */
.glass-panel {
  background: rgba(5, 10, 7, 0.95);
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 16px;
}

/* Enhanced glass with backdrop-filter support */
@supports (backdrop-filter: blur(1px)) or (-webkit-backdrop-filter: blur(1px)) {
  .glass-panel {
    background: rgba(5, 10, 7, 0.72);
    backdrop-filter: blur(16px) saturate(150%);
    -webkit-backdrop-filter: blur(16px) saturate(150%);
  }
}

/* Premium liquid glass - desktop only with pointer device */
@media (min-width: 992px) and (pointer: fine) {
  @supports (backdrop-filter: blur(1px)) {
    .glass-panel--premium {
      background:
        linear-gradient(135deg, rgba(255,255,255,0.04) 0%, transparent 50%),
        rgba(5, 10, 7, 0.65);
      backdrop-filter: blur(20px) saturate(180%) brightness(1.02);
      -webkit-backdrop-filter: blur(20px) saturate(180%) brightness(1.02);
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.06),
        0 20px 50px rgba(0,0,0,0.25);
    }
  }
}

/* ==========================================================================
   CSS CONTAINMENT - Isolate paint/layout for performance
   ========================================================================== */

/* Cards with spotlight effects - contain to prevent repaint bleed */
.card,
.live-card {
  contain: layout paint style;
}

/* Hero section - layout containment */
#hero {
  contain: layout;
}

/* Three.js canvas container - strict containment for GPU isolation */
#canvas-container {
  contain: strict;
}

/* Navbar - layout containment only (paint would break backdrop-filter) */
#main-header {
  contain: layout style;
}

/* Section containment for scroll performance */
.section {
  contain: layout style;
}

/* ==========================================================================
   GRADIENT TEXT FOR KEY HEADINGS
   ========================================================================== */

/* Gradient text - apply only to subpage heroes with simple .hero sections */
.gradient-text {
  background: linear-gradient(
    135deg,
    #ffffff 0%,
    #4caf50 50%,
    #81c784 100%
  );
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* Solid white text for subpage hero h1 - gradient breaks with split-text.js */
section.hero h1,
.hero h1 {
  color: #fff !important;
  -webkit-text-fill-color: #fff !important;
  background: none !important;
  -webkit-background-clip: unset !important;
  background-clip: unset !important;
}

/* Subtle shimmer animation on gradient text */
@keyframes gradient-shift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.gradient-text-animated {
  background-size: 200% 200%;
  animation: gradient-shift 8s ease infinite;
}

/* ==========================================================================
   AMBIENT GLOW BEHIND HERO IMAGES
   ========================================================================== */

/* Only apply to subpage hero visuals, not homepage hero-media which has its own effects */
.hero-visual {
  position: relative;
}

.hero-visual::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 80%;
  height: 80%;
  background: radial-gradient(
    ellipse at center,
    rgba(76, 175, 80, 0.3) 0%,
    rgba(76, 175, 80, 0.1) 40%,
    transparent 70%
  );
  filter: blur(60px);
  z-index: -1;
  pointer-events: none;
}

/* ==========================================================================
   ENHANCED CARD TILT/SPOTLIGHT EFFECTS
   ========================================================================== */

.card,
.live-card {
  --mouse-x: 50%;
  --mouse-y: 50%;
  position: relative;
  overflow: hidden;
}

/* Spotlight overlay that follows cursor */
.card::before,
.live-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: radial-gradient(
    600px circle at var(--mouse-x) var(--mouse-y),
    rgba(76, 175, 80, 0.1),
    transparent 40%
  );
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
  z-index: 1;
}

.card:hover::before,
.live-card:hover::before {
  opacity: 1;
}

/* Border glow effect */
.card::after,
.live-card::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: inherit;
  background: radial-gradient(
    400px circle at var(--mouse-x) var(--mouse-y),
    rgba(76, 175, 80, 0.3),
    transparent 40%
  );
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
  z-index: 0;
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask-composite: xor;
  -webkit-mask-composite: xor;
  padding: 1px;
}

.card:hover::after,
.live-card:hover::after {
  opacity: 1;
}

/* Ensure card content stays above effects */
.card > *,
.live-card > * {
  position: relative;
  z-index: 2;
}

/* ==========================================================================
   GLASSMORPHISM ENHANCEMENTS
   ========================================================================== */

.nav-dropdown-menu {
  background: rgba(5, 10, 7, 0.85) !important;
  backdrop-filter: blur(20px) saturate(180%) !important;
  -webkit-backdrop-filter: blur(20px) saturate(180%) !important;
  border: 1px solid rgba(255, 255, 255, 0.1) !important;
}

/* Make all dropdown items reveal (supporting >4 links like Amazon Wall Mat) */
.nav-dropdown:hover .nav-dropdown-item,
.nav-dropdown:focus-within .nav-dropdown-item {
  opacity: 1 !important;
  transform: translateX(0) !important;
}

/* ==========================================================================
   BLUR-TO-SHARP REVEAL ANIMATION
   DESKTOP ONLY - blur filter destroys mobile scroll performance
   ========================================================================== */

@media (min-width: 992px) {
  [data-reveal] {
    filter: blur(8px);
  }

  [data-reveal].reveal-in {
    filter: blur(0);
  }
}

/* ==========================================================================
   REDUCED MOTION SUPPORT
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  .gradient-text-animated {
    animation: none;
  }

  .card::before,
  .card::after,
  .live-card::before,
  .live-card::after {
    display: none;
  }

  [data-reveal] {
    filter: none;
  }
}

/* Data saver mode - disable visual flourishes to reduce bandwidth */
@media (prefers-reduced-data: reduce) {
  .glass-panel,
  .glass-panel--premium {
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
  }

  .hero-visual::before {
    display: none;
  }

  .gradient-text-animated {
    animation: none;
  }
}

/* ==========================================================================
   CONTENT VISUAL ENHANCEMENTS
   ========================================================================== */

/* Step number badges for process steps */
.step-number {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 2.5rem;
  height: 2.5rem;
  background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.1));
  border: 1px solid rgba(76, 175, 80, 0.3);
  border-radius: 50%;
  font-family: var(--font-heading);
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--color-accent);
  margin-bottom: 0.75rem;
}

/* Stat callout boxes for key numbers */
.stat-callout {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  padding: 1rem 1.5rem;
  background: linear-gradient(135deg, rgba(76, 175, 80, 0.08), rgba(76, 175, 80, 0.03));
  border: 1px solid rgba(76, 175, 80, 0.2);
  border-radius: 12px;
  text-align: center;
}

.stat-callout-value {
  font-family: var(--font-heading);
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--color-accent);
  line-height: 1.2;
}

.stat-callout-label {
  font-size: 0.85rem;
  color: var(--color-text-muted);
  margin-top: 0.25rem;
}

/* Stats row container */
.stats-row {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
  margin: 1.5rem 0;
}

/* Icon prefix for feature headings */
.feature-icon {
  display: inline-block;
  margin-right: 0.5rem;
  color: var(--color-accent);
}

/* Enhanced table styling with winner highlighting */
.table-winner {
  background: rgba(76, 175, 80, 0.08) !important;
}

.table-check {
  color: var(--color-accent);
  font-weight: 600;
}

.table-x {
  color: rgba(255, 255, 255, 0.4);
}

/* Section divider */
.section-divider {
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(76, 175, 80, 0.3), transparent);
  margin: 3rem 0;
}

/* Feature card with icon */
.feature-with-icon {
  position: relative;
  padding-left: 3.5rem;
}

.feature-with-icon .feature-icon-badge {
  position: absolute;
  left: 1.2rem;
  top: 1.2rem;
  font-size: 1.3rem;
}

/* Highlight box for important info */
.highlight-box {
  padding: 1.25rem;
  background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05));
  border-left: 3px solid var(--color-accent);
  border-radius: 0 12px 12px 0;
  margin: 1.5rem 0;
}

.highlight-box p {
  margin: 0;
  color: var(--color-text);
}

/* Process timeline connector */
.process-step {
  position: relative;
}

.process-step::before {
  content: '';
  position: absolute;
  left: 1.25rem;
  top: 3rem;
  bottom: -1.5rem;
  width: 2px;
  background: linear-gradient(180deg, rgba(76, 175, 80, 0.3), transparent);
}

.process-step:last-child::before {
  display: none;
}

/* FAQ toggle indicator */
details summary {
  position: relative;
  padding-right: 2rem;
}

details summary::after {
  content: '+';
  position: absolute;
  right: 0;
  top: 50%;
  transform: translateY(-50%);
  font-size: 1.2rem;
  color: var(--color-accent);
  transition: transform 0.2s ease;
}

details[open] summary::after {
  content: 'âˆ’';
}

/* Comparison table enhancements */
.comparison-table th:last-child,
.comparison-table td:last-child {
  background: rgba(76, 175, 80, 0.05);
}

/* Animated counter effect placeholder */
.counter-value {
  font-family: var(--font-heading);
  font-size: 2rem;
  font-weight: 700;
  color: var(--color-accent);
}

/* ==========================================================================
   MOBILE HERO TEXT READABILITY
   ========================================================================== */

@media (max-width: 991px) {
  /* MOBILE: Disable GPU-intensive effects for scroll performance */

  /* Disable all backdrop-filter on mobile - causes scroll jank */
  .glass-panel,
  .glass-panel--premium {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
    background: rgba(5, 10, 7, 0.95) !important;
  }

  /* MOBILE: Keep hero elements visible, ensure text is readable */

  /* Hero content must stay positioned for z-index to work */
  .hero-content {
    position: relative !important;
    z-index: 10 !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

  /* Remove transforms from animated elements to prevent scroll jank */
  .hero-content *,
  .gs-fade-up {
    transform: none !important;
    will-change: auto !important;
    animation: none !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

  /* Boost text contrast on mobile */
  .hero-content h1 span {
    text-shadow: 0 2px 20px rgba(0, 0, 0, 0.8);
  }

  .hero-content p {
    text-shadow: 0 1px 10px rgba(0, 0, 0, 0.7);
  }

  /* Reduce hero padding on mobile for better content positioning */
  #hero {
    padding-top: clamp(6rem, 10vw, 9rem) !important; /* vw not vh - width doesn't change on iOS scroll */
    padding-bottom: 4rem !important;
  }
}

/* ==========================================================================
   MOBILE TEXAS MAP FIX
   ========================================================================== */

/* Fix SVG text positioning in map */
.map-label {
  dominant-baseline: middle;
}

/* Ensure map cities render properly */
.map-city {
  transform-box: fill-box;
}

/* ==========================================================================
   MOBILE FONT SIZE FIXES
   Ensure all text is readable on mobile (min 12px rendered)
   ========================================================================== */

@media (max-width: 768px) {
  /* Fix very small fonts that are hard to read on mobile */
  .nav-caret,
  .item-category,
  .eyebrow,
  .pill,
  .badge,
  .stat-pill,
  .input-hint {
    font-size: 0.75rem !important; /* 12px minimum */
  }

  /* Slightly larger fonts that were still too small */
  .nav-dropdown-item,
  .meta-row,
  .stat-callout-label,
  .spec-label {
    font-size: 0.875rem !important; /* 14px */
  }

  /* Ensure buttons have adequate touch targets */
  .btn,
  button,
  [role="button"] {
    min-height: 44px;
    padding: 12px 16px;
  }

  /* Accordion touch targets */
  .accordion,
  details summary {
    min-height: 44px;
    padding: 12px 0;
  }

  /* Filter buttons in gallery */
  .filter-btn {
    min-height: 44px;
    padding: 10px 16px;
    font-size: 0.875rem;
  }

  /* Card improvements for mobile */
  .card,
  .system-card,
  .foliage-card {
    padding: 1rem;
  }

  /* Lightbox nav buttons for mobile */
  .lightbox-nav {
    min-width: 48px;
    min-height: 48px;
    padding: 12px;
  }
}
